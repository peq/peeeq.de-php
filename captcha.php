<?$charmap = 'ABCDEFGHJKLMNPRTUVWXYZ';session_start();$RandomStr = md5(microtime());$ResultStr = '';for ($i=0;$i<4;$i++)	$ResultStr .= $charmap[rand(0,strlen($charmap)-1)];$NewImage =imagecreatefromjpeg("img.jpg");$TextColor = imagecolorallocate($NewImage, 0, 0, 0);$TextColor2 = imagecolorallocate($NewImage, 255, 255, 255);for ($i=0;$i<10;$i++){	$LineColor = imagecolorallocate($NewImage,rand(0,200),rand(0,200),rand(0,200));	imageline($NewImage,rand(0,81),rand(0,81),rand(0,34),rand(0,34),$LineColor);}$x = rand(2,40);$y = rand(2,20);imagestring($NewImage, 100, $x, $y, $ResultStr, $TextColor);imagestring($NewImage, 100, $x+1, $y+1, $ResultStr, $TextColor2);$_SESSION['captcha'] = $ResultStr;header("Content-type: image/jpeg");imagejpeg($NewImage);?>